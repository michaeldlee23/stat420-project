---
title: "STAT 420 â€” Project"
author: "Winston Chen, Daniel hooks, Naidan Ganbold, Erik Janc, Michael Lee"
date: "November 19, 2021"
output:
  html_notebook: default
  pdf_document: default
---
```{r setup, include=FALSE}
library(finalfit)
library(knitr)
library(tidyverse)
library(tidyquant)

knitr::opts_chunk$set(echo=TRUE, error=TRUE, eval=TRUE)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```
## Introduction

## Data Preprocessing
Read the initial CSV file:
```{r}
pollution_raw = read.csv(
  "./data/pollution_us_2000_2016.csv",
  header=TRUE,
)
colnames(pollution_raw)
```
Only include records for the following cities:

* Los Angeles
* New York

Additionally, for ease of viewing, drop irrelevant columns that we are not analyzing.
```{r}
#cities = c("Dallas", "Pheonix", "Los Angeles", "New York", "Vandenberg Air Force Base")
cities = c("Los Angeles", "New York")
pollution = subset(
  pollution_raw,
  pollution_raw$City %in% cities,
  drop=TRUE
)

#cols = c("State", "County", "City", "Date.Local", "NO2.Units", "NO2.Mean", "O3.Units", "O3.Mean", "SO2.Units", "SO2.Mean", "CO.Units", "CO.Mean")
cols = c("City", "Date.Local", "NO2.Mean", "O3.Mean", "SO2.Mean", "CO.Mean")
pollution = pollution[cols]
head(pollution)
```
Note that the we have the following units for each pollutant measurement, which we drop from the table for brevity:

* NO2 : parts per billion
* O3 : parts per million
* SO2 : parts per billion
* CO : parts per million

For each city, each day includes four separate rows with differing measurements. We average the columns so that there is only one measurement per day.
```{r}
pollution = pollution %>% 
  group_by(City, Date.Local) %>%
  summarize_each(mean)
pollution$Date.Local = as.Date(pollution$Date.Local, format="%Y-%m-%d")
head(pollution)
```

## Exploratory Data Analysis

```{r}
plot_city = function(city, pollutant) {
  plot(
    pollution[pollution$City==city,]$Date.Local,
    pollution[pollution$City==city,][[pollutant]],
    xlab="Year",
    ylab="Mean CO (parts per million)",
    type='l',
    main=paste(city, pollutant)
  )
}

plot_city("Los Angeles", "CO.Mean")
```
```{r}
plot_city("New York", "CO.Mean")
```

## Forecasting

## Conclusion